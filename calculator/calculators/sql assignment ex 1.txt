   /*
	Query-1.6:: Display the overall Average of the [CurrencyRate].[AverageRate] values for 
				the exchange rate ‘USD’ to ‘GBP’ for the year 2005 
				i.e. FromCurrencyCode = ‘USD’ and ToCurrencyCode = ‘GBP’. 
				Note: The field [CurrencyRate].[AverageRate] is defined as 
				'Average exchange rate for the day.' (Schema(s) involved: Sales)
*/

SELECT AVG(AverageRate) AS 'Average exchange rate for the day'
FROM Sales.CurrencyRate
WHERE FromCurrencyCode = 'USD' AND 
	  ToCurrencyCode = 'GBP';

	  /*
	Query-1.7:: Display the FirstName and LastName of records from the Person table 
				where FirstName contains the letters ‘ss’. Display an additional column 
				with sequential numbers for each row returned beginning at integer 1. 
				(Schema(s) involved: Person)
*/

SELECT ROW_NUMBER() OVER(ORDER BY FirstName) AS 'Sequence',
	   FirstName,
	   LastName
FROM Person.Person
WHERE FirstName LIKE '%ss%';


/*
	Query-1.8:: Sales people receive various commission rates that belong to 1 of 4 bands.
				(Schema(s) involved: Sales)
				CommissionPct	Commission Band
				0.00			Band 0
				Up To 1%		Band 1
				Up To 1.5%		Band 2
				Greater 1.5%	Band 3
				
				Display the [SalesPersonID] with an additional column entitled ‘Commission Band’ 
				indicating the appropriate band as above.
*/

SELECT BusinessEntityID AS 'SalesPersonID',
	   CASE
			WHEN CommissionPct = 0.00 THEN 'BAND 0'
			WHEN CommissionPct > 0.00 AND CommissionPct <= 0.01 THEN 'BAND 1'
			WHEN CommissionPct > 0.01 AND CommissionPct <= 0.015 THEN 'BAND 2'
			WHEN CommissionPct > 0.015 THEN 'BAND 3'
	   END AS 'Commission Band'
FROM Sales.SalesPerson
ORDER BY [Commission Band];



/*
	Query-1.10:: Display the ProductId of the product with the largest stock level. 
				 Hint: Use the Scalar-valued function [dbo]. [UfnGetStock]. 
				 (Schema(s) involved: Production)
*/

SELECT ProductID AS 'Product ID'
FROM Production.Product
WHERE SafetyStockLevel = (SELECT MAX(SafetyStockLevel)
						  FROM Production.Product);
